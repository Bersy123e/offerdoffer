{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block branding %}
<h1 id="site-name"><a href="{% url 'admin:index' %}">{{ site_header|default:_('Django administration') }}</a></h1>
{% endblock %}

{% block nav-global %}{% endblock %}

{% block content %}
<div class="module">
    <h1>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã "–ê–†–ú–ê–°–ï–¢–ò –ò–ú–ü–û–†–¢"</h1>
    <p class="help">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: {{ analytics.generated_at }}</p>
</div>

<!-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ -->
<div class="module">
    <h2>üìà –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
    <table>
        <tbody>
            <tr>
                <th scope="row">üì¶ –¢–æ–≤–∞—Ä—ã –≤ –±–∞–∑–µ:</th>
                <td><strong>{{ analytics.database_stats.total_products }}</strong></td>
            </tr>
            <tr>
                <th scope="row">üè™ –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏:</th>
                <td><strong>{{ analytics.database_stats.total_suppliers }}</strong></td>
            </tr>
            <tr>
                <th scope="row">üìã –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–∑–∞ {{ analytics.proposal_stats.period_days }} –¥–Ω.):</th>
                <td><strong>{{ analytics.proposal_stats.total_proposals }}</strong></td>
            </tr>
            <tr>
                <th scope="row">üîç –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:</th>
                <td><strong>{{ analytics.search_stats.total_searches }}</strong></td>
            </tr>
            <tr>
                <th scope="row">üí∞ –¢–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–∞–º–∏:</th>
                <td><strong>{{ analytics.database_stats.products_with_prices }}</strong></td>
            </tr>
        </tbody>
    </table>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π -->
<div class="module">
    <h2>üìã –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</h2>
    <table>
        <tbody>
            <tr>
                <th scope="row">–ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞:</th>
                <td>{{ analytics.proposal_stats.start_date }} - {{ analytics.proposal_stats.end_date }}</td>
            </tr>
            <tr>
                <th scope="row">–í—Å–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:</th>
                <td><strong>{{ analytics.proposal_stats.total_proposals }}</strong></td>
            </tr>
            <tr>
                <th scope="row">–¢–æ–≤–∞—Ä–æ–≤ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö:</th>
                <td><strong>{{ analytics.proposal_stats.total_products_in_proposals }}</strong></td>
            </tr>
            <tr>
                <th scope="row">–°—Ä–µ–¥–Ω–µ–µ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ö–ü:</th>
                <td><strong>{{ analytics.proposal_stats.avg_products_per_proposal }}</strong></td>
            </tr>
        </tbody>
    </table>
</div>

<!-- –¢–æ–ø –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ -->
{% if analytics.top_suppliers %}
<div class="module">
    <h2>üè™ –¢–æ–ø –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–æ–≤–∞—Ä–æ–≤</h2>
    <table>
        <thead>
            <tr>
                <th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤</th>
            </tr>
        </thead>
        <tbody>
            {% for supplier in analytics.top_suppliers %}
            <tr>
                <td>{{ supplier.name }}</td>
                <td><strong>{{ supplier.product_count }}</strong></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã -->
{% if analytics.popular_searches %}
<div class="module">
    <h2>üîç –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã</h2>
    <table>
        <thead>
            <tr>
                <th>–ó–∞–ø—Ä–æ—Å</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–æ–≤</th>
            </tr>
        </thead>
        <tbody>
            {% for search in analytics.popular_searches %}
            <tr>
                <td>{{ search.query_text }}</td>
                <td><strong>{{ search.search_count }}</strong></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º -->
{% if analytics.supplier_distribution %}
<div class="module">
    <h2>üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º</h2>
    <table>
        <thead>
            <tr>
                <th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤</th>
                <th>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ</th>
            </tr>
        </thead>
        <tbody>
            {% for supplier in analytics.supplier_distribution %}
            <tr>
                <td><strong>{{ supplier.name }}</strong></td>
                <td>{{ supplier.product_count }}</td>
                <td>{{ supplier.percentage }}%</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∏—Å–∫–∞ -->
<div class="module">
    <h2>üîç –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∏—Å–∫–∞</h2>
    <table>
        <tbody>
            <tr>
                <th scope="row">–í—Å–µ–≥–æ –ø–æ–∏—Å–∫–æ–≤:</th>
                <td><strong>{{ analytics.search_stats.total_searches }}</strong></td>
            </tr>
            <tr>
                <th scope="row">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:</th>
                <td><strong>{{ analytics.search_stats.unique_queries }}</strong></td>
            </tr>
            <tr>
                <th scope="row">–°—Ä–µ–¥–Ω–µ–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –ø–æ–∏—Å–∫:</th>
                <td><strong>{{ analytics.search_stats.avg_results_per_search|floatformat:1 }}</strong></td>
            </tr>
        </tbody>
    </table>
</div>

<!-- –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
<div class="module">
    <h2>üöß –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
    <div class="help">
        <p><strong>üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:</strong> –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
        <p><strong>üìä –û—Ç—á–µ—Ç—ã:</strong> PDF –æ—Ç—á–µ—Ç—ã, Excel —ç–∫—Å–ø–æ—Ä—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞</p>
        <p><strong>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏:</strong> –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã</p>
    </div>
</div>

<div class="module">
    <p>
        <a href="{% url 'admin:index' %}" class="button">‚¨ÖÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π</a>
        <a href="/admin/analytics/info/" class="button" style="margin-left: 10px;">üîç –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
    </p>
</div>

<style>
.module {
    margin-bottom: 20px;
}

.module h2 {
    background: #417690;
    color: white;
    padding: 8px 12px;
    margin: 0;
    font-size: 14px;
    font-weight: bold;
}

.module table {
    width: 100%;
    border-collapse: collapse;
}

.module table th,
.module table td {
    padding: 8px 12px;
    border-bottom: 1px solid #ddd;
    text-align: left;
}

.module table th {
    background: #f8f8f8;
    font-weight: bold;
}

.help {
    padding: 12px;
    background: #f8f8f8;
    border-left: 4px solid #417690;
    font-size: 13px;
    color: #666;
}
</style>
{% endblock %} 